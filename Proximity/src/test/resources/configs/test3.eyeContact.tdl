CREATE typed(@path='datasets/eye_signals',@part_count=4);
TRANSFORM typed textToColumnar VALUE(lat,lon,userid,timestamp);

CREATE pois (@path='datasets/poi_2_with_duplicates');
TRANSFORM pois textToColumnar VALUE (id,azimuth,radius,viewing_angle,lat,lon);
TRANSFORM pois columnarToPoint(@lon_column=lon,@lat_column=lat,@radius_column=radius);

TRANSFORM typed columnarToTrack(
@userid_column=userid,
@lat_column=lat,
@lon_column=lon,
@ts_column=timestamp);

CALL eyeContact(
@angle_prop=viewing_angle,
@azimuth_prop=azimuth)
INPUT pois FROM pois, tracks FROM typed OUTPUT result;
